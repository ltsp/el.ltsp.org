# Εικονικές μηχανές (Virtual Machines)

Η Τ.Σ. του Π.Σ.Δ. έχει δημιουργήσει και συντηρεί έτοιμες εικονικές
μηχανές:

1.  [Ubuntu Bionic MATE 18.04 **32 bit**](https://ts.sch.gr/repo/images/VMs/bionic-mate.squashfs)

2.  [Ubuntu Focal MATE 20.04 **64 bit**](https://ts.sch.gr/repo/images/VMs/focal-mate.squashfs)

τις οποίες μπορείτε να χρησιμοποιείτε με διάφορους τρόπους, όπως:

-   Ως Λειτουργικό Σύστημα (Λ.Σ.) δοκιμών (***VirtualBox***) μέσα στο
    πραγματικό Λ.Σ. που ήδη έχετε.

-   Αν έχετε μικτό εργαστήριο 32/64 bit clients, ως **εικονικό** 32 bit LTSP
    server (***VirtualBox***) μέσα σε **πραγματικό** 64 bit LTSP server, χωρίς
    έτσι να χρειάζεται η αγορά/ύπαρξη δεύτερου πραγματικού LTSP server.

-   Ως το κύριο Λ.Σ., μετατρέποντας τον εικονικό σκληρό δίσκο `.vmdk`, σε
    πραγματικό partition του σκληρού σας δίσκου (**Κλωνοποίηση**).

## Λ.Σ. δοκιμών (VirtualBox) {:#virtualbox}

Για να κάνετε χρήση της έτοιμης εικονικής μηχανής π.χ. της Ubuntu Focal MATE
20.04 **64 bit**, θα πρέπει να ακολουθήσετε τα επόμενα βήματα:

1.  Από [τερματικό](../../glossary#terminal), την "κατεβάζετε" σε συμπιεσμένη
    μορφή στο φάκελο `ts-sch-VMs` και την αποσυμπιέζετε στο φάκελο
    `ts-sch-VMs/focal-mate`:

    ```shell
    mkdir -p ts-sch-VMs
    cd ts-sch-VMs
    wget https://ts.sch.gr/repo/images/VMs/focal-mate.squashfs
    unsquashfs -f -d focal-mate focal-mate.squashfs
    ```

    !!! tip ""
        Αν χρειαστείτε και την `bionic-mate`, στις εντολές όπου `focal-mate`
        βάλτε `bionic-mate`.

2.  [Εγκατάσταση](../../ubuntu/software.md) του ***VirtualBox***. Μόλις
    ολοκληρωθεί η εγκατάσταση, θα το βρείτε στο ***Εφαρμογές*** ▸ ***Εργαλεία
    συστήματος*** ▸ ***VirtualBox***.

    !!! tip ""
        Για να εμφανιστεί στο μενού το ***VirtualBox*** θα πρέπει να κάνετε
        ***Αποσύνδεση*** και να επανασυνδεθείτε.

3.  Εισαγωγή της εικονικής μηχανής `focal-mate.vbox` στο VirtualBox από το
    μενού: ***Μηχανή*** ▸ ***Προσθήκη...*** ή με **`Ctrl`**+**`A`**.

    !!! tip ""
        Το αρχείο `focal-mate.vbox` βρίσκεται στον φάκελο
        `ts-sch-VMs/focal-mate`.

4.  Πριν επιλέξετε ***Εκκίνηση*** θα πρέπει να ελέγξετε τις ***Ρυθμίσεις*** της
    εικονικής μηχανής. Το κυριότερο είναι το μέγεθος της μνήμης **RAM** να
    είναι στα **προτεινόμενα όρια**.

    [![](VT-x_BIOS.png)](VT-x_BIOS.png)
    !!! tip "Χρήσιμο"
        Σε περίπτωση που κατά την ***Εκκίνηση*** εμφανιστεί το μήνυμα της
        διπλανής εικόνας, θα πρέπει από το BIOS/UEFI να ενεργοποιήσετε την
        επιλογή ***Intel Virtualization Technology (VT-x)***. Το αντίστοιχο
        μήνυμα για AMD CPU θα είναι: `AMD-V is disabled in the BIOS`.

## Μετατροπή εικονικού δίσκου (vmdk), σε πραγματικό (partition) - Κλωνοποίηση μέσω τοπικού δικτύου (LTSP) {:#vmdk-partition-lan-ltsp}

### Σενάριο

Έχετε ήδη εγκαταστημένο LTSP server και θέλετε να εγκαταστήσετε Ubuntu MATE σε
υπολογιστή μέσω του τοπικού δικτύου έτσι ώστε στη συνέχεια να τον
χρησιμοποιήσετε ως standalone θέση εργασίας ή να τον μετατρέψετε σε LTSP
server.

### Προϋποθέσεις

-   Λειτουργικός LTSP server.
-   Τοπικό δίκτυο. Προτείνεται στα 1000 Mbps έτσι ώστε να γίνει πολύ γρήγορα η
    εγγραφή του εικονικού.
-   Υπολογιστής "στόχος" με τις προτεινόμενες
    [προδιαγραφές](../../ltsp/requirements.md).
-   Κατάλληλες ρυθμίσεις στο BIOS "στόχου", ώστε να είναι σε BIOS mode (ή
    UEFI/legacy mode), γιατί και ο εικονικός `.vmdk` είναι σε BIOS/MBR mode.
-   Εφαρμογή **μόνο** του 1ου βήματος της ενότητας [Λ.Σ. δοκιμών
    (VirtualBox)](#virtualbox).

### Βήματα υλοποίησης

1.  [Εκκίνηση από το δίκτυο](../../ltsp/netboot.md) του υπολογιστή "στόχου".

2.  Σύνδεση ως `administrator` στον υπολογιστή "στόχο".

3.  Από [τερματικό](../../glossary#terminal) π.χ. ως `administrator@ltsp147`:

    !!! warning "Προσοχή"
        Η εντολή `dd` διαγράφει **όλα** τα δεδομένα του δίσκου **οριστικά**!!!

    ```shell
    # Απενεργοποίηση τυχόν τοπικών swap files.
    sudo swapoff -a
    # Εύρεση του "ονόματος" του τοπικού δίσκου (π.χ. sda).
    lsblk --fs
    # Εγγραφή του .vmdk στον τοπικό δίσκο (π.χ. sda).
    sudo dd if=/home/administrator/ts-sch-VMs/focal-mate/focal-mate-flat.vmdk of=/dev/sda bs=1M status=progress
    ```

4.  **Χωρίς** να κάνετε **επανεκκίνηση** τον υπολογιστή "στόχο" συνεχίζεται στο
    τερματικό π.χ. για `/dev/sda`:

    ```shell
    gparted /dev/sda
    ```

    Στο [GParted](https://ts.sch.gr/docs/linux/guides/gparted/) πρέπει να γίνουν δύο βασικές ενέργειες:

    1.  **Αύξηση** του μεγέθους του swap partition ***/dev/sda2*** σε 4100 MB
        και **μετακίνηση** του στο τέλος του δίσκου. **Πριν** το επόμενο βήμα
        να γίνει ***Εφαρμογή όλων των εργασιών*** (εικονίδιο
        ![](../gparted/Gparted-apply-new-partition.png#inline)).

    2.  **Αύξηση** του μεγέθους του linux partition ***/dev/sda1*** ώστε να
        καταλαμβάνει όλο το διαθέσιμο δίσκο και ***Εφαρμογή όλων των
        εργασιών*** (εικονίδιο
        ![](../gparted/Gparted-apply-new-partition.png#inline)).

Ο υπολογιστής "στόχος" είναι έτοιμος. Μπορείτε να κάνετε επανεκκίνηση ώστε να
ελέγξετε ότι είναι λειτουργικός.

!!! info "Πληροφορία"
    Ο οδηγός των διαφόρων μεθόδων κλωνοποίησης θα ενημερώνεται συνεχώς. Για περισσοτερες πληροφορίες/λύσεις/απορίες δείτε:

    -   [Κλωνοποίηση εγκαταστάσεων Linux/Windows](https://alkisg.mysch.gr/steki/index.php?topic=7658.0)
    -   [Κλωνοποίηση δίσκου UEFI](https://alkisg.mysch.gr/steki/index.php?topic=8762.0)
    -   [Απομακρυσμένη κλωνοποίηση δίσκου από ΠΛΗΝΕΤ σε
        σχολείο](https://alkisg.mysch.gr/steki/index.php?topic=8602.0)
